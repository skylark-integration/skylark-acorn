/**
 * skylark-acorn - A version of acorn that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./state","./tokentype","./whitespace"],function(t,e,n){"use strict";const{Parser:o}=t,{types:i}=e,{lineBreak:s}=n;class r{constructor(t,e,n,o,i){this.token=t,this.isExpr=!!e,this.preserveSpace=!!n,this.override=o,this.generator=!!i}}const p={b_stat:new r("{",!1),b_expr:new r("{",!0),b_tmpl:new r("${",!1),p_stat:new r("(",!1),p_expr:new r("(",!0),q_tmpl:new r("`",!0,!0,t=>t.tryReadTemplateToken()),f_stat:new r("function",!1),f_expr:new r("function",!0),f_expr_gen:new r("function",!0,!1,null,!0),f_gen:new r("function",!1,!1,null,!0)},c=o.prototype;return c.initialContext=function(){return[p.b_stat]},c.curContext=function(){return this.context[this.context.length-1]},c.braceIsBlock=function(t){let e=this.curContext();return e===p.f_expr||e===p.f_stat||(t!==i.colon||e!==p.b_stat&&e!==p.b_expr?t===i._return||t===i.name&&this.exprAllowed?s.test(this.input.slice(this.lastTokEnd,this.start)):t===i._else||t===i.semi||t===i.eof||t===i.parenR||t===i.arrow||(t===i.braceL?e===p.b_stat:t!==i._var&&t!==i._const&&t!==i.name&&!this.exprAllowed):!e.isExpr)},c.inGeneratorContext=function(){for(let t=this.context.length-1;t>=1;t--){let e=this.context[t];if("function"===e.token)return e.generator}return!1},c.updateContext=function(t){let e,n=this.type;n.keyword&&t===i.dot?this.exprAllowed=!1:(e=n.updateContext)?e.call(this,t):this.exprAllowed=n.beforeExpr},c.overrideContext=function(t){this.curContext()!==t&&(this.context[this.context.length-1]=t)},i.parenR.updateContext=i.braceR.updateContext=function(){if(1===this.context.length)return void(this.exprAllowed=!0);let t=this.context.pop();t===p.b_stat&&"function"===this.curContext().token&&(t=this.context.pop()),this.exprAllowed=!t.isExpr},i.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?p.b_stat:p.b_expr),this.exprAllowed=!0},i.dollarBraceL.updateContext=function(){this.context.push(p.b_tmpl),this.exprAllowed=!0},i.parenL.updateContext=function(t){let e=t===i._if||t===i._for||t===i._with||t===i._while;this.context.push(e?p.p_stat:p.p_expr),this.exprAllowed=!0},i.incDec.updateContext=function(){},i._function.updateContext=i._class.updateContext=function(t){!t.beforeExpr||t===i._else||t===i.semi&&this.curContext()!==p.p_stat||t===i._return&&s.test(this.input.slice(this.lastTokEnd,this.start))||(t===i.colon||t===i.braceL)&&this.curContext()===p.b_stat?this.context.push(p.f_stat):this.context.push(p.f_expr),this.exprAllowed=!1},i.backQuote.updateContext=function(){this.curContext()===p.q_tmpl?this.context.pop():this.context.push(p.q_tmpl),this.exprAllowed=!1},i.star.updateContext=function(t){if(t===i._function){let t=this.context.length-1;this.context[t]===p.f_expr?this.context[t]=p.f_expr_gen:this.context[t]=p.f_gen}this.exprAllowed=!0},i.name.updateContext=function(t){let e=!1;this.options.ecmaVersion>=6&&t!==i.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e},{TokContext:r,types:p}});
//# sourceMappingURL=sourcemaps/tokencontext.js.map
