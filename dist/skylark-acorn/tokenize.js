/**
 * skylark-acorn - A version of acorn that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./identifier","./tokentype","./tokentype","./state","./locutil","./regexp","./whitespace","./util"],function(t,i,s,e,n,h,o,r){"use strict";const{isIdentifierStart:a,isIdentifierChar:p}=t,{Parser:c}=e,{SourceLocation:u}=n,{RegExpValidationState:l}=h,{lineBreak:d,nextLineBreak:f,isNewLine:k,nonASCIIwhitespace:m}=o,{codePointToString:C}=r;class T{constructor(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new u(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])}}const g=c.prototype;function A(t){return"function"!=typeof BigInt?null:BigInt(t.replace(/_/g,""))}g.next=function(t){!t&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new T(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},g.getToken=function(){return this.next(),new T(this)},"undefined"!=typeof Symbol&&(g[Symbol.iterator]=function(){return{next:()=>{let t=this.getToken();return{done:t.type===i.eof,value:t}}}}),g.nextToken=function(){let t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(i.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},g.readToken=function(t){return a(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},g.fullCharCodeAtPos=function(){let t=this.input.charCodeAt(this.pos);if(t<=55295||t>=56320)return t;let i=this.input.charCodeAt(this.pos+1);return i<=56319||i>=57344?t:(t<<10)+i-56613888},g.skipBlockComment=function(){let t=this.options.onComment&&this.curPosition(),i=this.pos,s=this.input.indexOf("*/",this.pos+=2);if(-1===s&&this.raise(this.pos-2,"Unterminated comment"),this.pos=s+2,this.options.locations)for(let t,s=i;(t=f(this.input,s,this.pos))>-1;)++this.curLine,s=this.lineStart=t;this.options.onComment&&this.options.onComment(!0,this.input.slice(i+2,s),i,this.pos,t,this.curPosition())},g.skipLineComment=function(t){let i=this.pos,s=this.options.onComment&&this.curPosition(),e=this.input.charCodeAt(this.pos+=t);for(;this.pos<this.input.length&&!k(e);)e=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(i+t,this.pos),i,this.pos,s,this.curPosition())},g.skipSpace=function(){t:for(;this.pos<this.input.length;){let t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&m.test(String.fromCharCode(t))))break t;++this.pos}}},g.finishToken=function(t,i){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());let s=this.type;this.type=t,this.value=i,this.updateContext(s)},g.readToken_dot=function(){let t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);let s=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===s?(this.pos+=3,this.finishToken(i.ellipsis)):(++this.pos,this.finishToken(i.dot))},g.readToken_slash=function(){let t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(i.assign,2):this.finishOp(i.slash,1)},g.readToken_mult_modulo_exp=function(t){let s=this.input.charCodeAt(this.pos+1),e=1,n=42===t?i.star:i.modulo;return this.options.ecmaVersion>=7&&42===t&&42===s&&(++e,n=i.starstar,s=this.input.charCodeAt(this.pos+2)),61===s?this.finishOp(i.assign,e+1):this.finishOp(n,e)},g.readToken_pipe_amp=function(t){let s=this.input.charCodeAt(this.pos+1);if(s===t){if(this.options.ecmaVersion>=12){if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(i.assign,3)}return this.finishOp(124===t?i.logicalOR:i.logicalAND,2)}return 61===s?this.finishOp(i.assign,2):this.finishOp(124===t?i.bitwiseOR:i.bitwiseAND,1)},g.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(i.assign,2):this.finishOp(i.bitwiseXOR,1)},g.readToken_plus_min=function(t){let s=this.input.charCodeAt(this.pos+1);return s===t?45!==s||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!d.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(i.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===s?this.finishOp(i.assign,2):this.finishOp(i.plusMin,1)},g.readToken_lt_gt=function(t){let s=this.input.charCodeAt(this.pos+1),e=1;return s===t?(e=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+e)?this.finishOp(i.assign,e+1):this.finishOp(i.bitShift,e)):33!==s||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===s&&(e=2),this.finishOp(i.relational,e)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},g.readToken_eq_excl=function(t){let s=this.input.charCodeAt(this.pos+1);return 61===s?this.finishOp(i.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===s&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(i.arrow)):this.finishOp(61===t?i.eq:i.prefix,1)},g.readToken_question=function(){const t=this.options.ecmaVersion;if(t>=11){let s=this.input.charCodeAt(this.pos+1);if(46===s){let t=this.input.charCodeAt(this.pos+2);if(t<48||t>57)return this.finishOp(i.questionDot,2)}if(63===s){if(t>=12){if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(i.assign,3)}return this.finishOp(i.coalesce,2)}}return this.finishOp(i.question,1)},g.readToken_numberSign=function(){let t=35;if(this.options.ecmaVersion>=13&&(++this.pos,t=this.fullCharCodeAtPos(),a(t,!0)||92===t))return this.finishToken(i.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+C(t)+"'")},g.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(i.parenL);case 41:return++this.pos,this.finishToken(i.parenR);case 59:return++this.pos,this.finishToken(i.semi);case 44:return++this.pos,this.finishToken(i.comma);case 91:return++this.pos,this.finishToken(i.bracketL);case 93:return++this.pos,this.finishToken(i.bracketR);case 123:return++this.pos,this.finishToken(i.braceL);case 125:return++this.pos,this.finishToken(i.braceR);case 58:return++this.pos,this.finishToken(i.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(i.backQuote);case 48:let s=this.input.charCodeAt(this.pos+1);if(120===s||88===s)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===s||79===s)return this.readRadixNumber(8);if(98===s||66===s)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 63:return this.readToken_question();case 126:return this.finishOp(i.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+C(t)+"'")},g.finishOp=function(t,i){let s=this.input.slice(this.pos,this.pos+i);return this.pos+=i,this.finishToken(t,s)},g.readRegexp=function(){let t,s,e=this.pos;for(;;){this.pos>=this.input.length&&this.raise(e,"Unterminated regular expression");let i=this.input.charAt(this.pos);if(d.test(i)&&this.raise(e,"Unterminated regular expression"),t)t=!1;else{if("["===i)s=!0;else if("]"===i&&s)s=!1;else if("/"===i&&!s)break;t="\\"===i}++this.pos}let n=this.input.slice(e,this.pos);++this.pos;let h=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(h);const r=this.regexpState||(this.regexpState=new l(this));r.reset(e,n,o),this.validateRegExpFlags(r),this.validateRegExpPattern(r);let a=null;try{a=new RegExp(n,o)}catch(t){}return this.finishToken(i.regexp,{pattern:n,flags:o,value:a})},g.readInt=function(t,i,s){const e=this.options.ecmaVersion>=12&&void 0===i,n=s&&48===this.input.charCodeAt(this.pos);let h=this.pos,o=0,r=0;for(let s=0,h=null==i?1/0:i;s<h;++s,++this.pos){let i,h=this.input.charCodeAt(this.pos);if(e&&95===h)n&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===r&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===s&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),r=h;else{if((i=h>=97?h-97+10:h>=65?h-65+10:h>=48&&h<=57?h-48:1/0)>=t)break;r=h,o=o*t+i}}return e&&95===r&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===h||null!=i&&this.pos-h!==i?null:o},g.readRadixNumber=function(t){let s=this.pos;this.pos+=2;let e=this.readInt(t);return null==e&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(e=A(this.input.slice(s,this.pos)),++this.pos):a(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(i.num,e)},g.readNumber=function(t){let s=this.pos;t||null!==this.readInt(10,void 0,!0)||this.raise(s,"Invalid number");let e=this.pos-s>=2&&48===this.input.charCodeAt(s);e&&this.strict&&this.raise(s,"Invalid number");let n=this.input.charCodeAt(this.pos);if(!e&&!t&&this.options.ecmaVersion>=11&&110===n){let t=A(this.input.slice(s,this.pos));return++this.pos,a(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(i.num,t)}e&&/[89]/.test(this.input.slice(s,this.pos))&&(e=!1),46!==n||e||(++this.pos,this.readInt(10),n=this.input.charCodeAt(this.pos)),69!==n&&101!==n||e||(43!==(n=this.input.charCodeAt(++this.pos))&&45!==n||++this.pos,null===this.readInt(10)&&this.raise(s,"Invalid number")),a(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");let h=(o=this.input.slice(s,this.pos),e?parseInt(o,8):parseFloat(o.replace(/_/g,"")));var o;return this.finishToken(i.num,h)},g.readCodePoint=function(){let t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();let i=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(i,"Code point out of bounds")}else t=this.readHexChar(4);return t},g.readString=function(t){let s="",e=++this.pos;for(;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");let i=this.input.charCodeAt(this.pos);if(i===t)break;92===i?(s+=this.input.slice(e,this.pos),s+=this.readEscapedChar(!1),e=this.pos):8232===i||8233===i?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(k(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return s+=this.input.slice(e,this.pos++),this.finishToken(i.string,s)};const b={};return g.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t!==b)throw t;this.readInvalidTemplateToken()}this.inTemplateElement=!1},g.invalidStringToken=function(t,i){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw b;this.raise(t,i)},g.readTmplToken=function(){let t="",s=this.pos;for(;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");let e=this.input.charCodeAt(this.pos);if(96===e||36===e&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==i.template&&this.type!==i.invalidTemplate?(t+=this.input.slice(s,this.pos),this.finishToken(i.template,t)):36===e?(this.pos+=2,this.finishToken(i.dollarBraceL)):(++this.pos,this.finishToken(i.backQuote));if(92===e)t+=this.input.slice(s,this.pos),t+=this.readEscapedChar(!0),s=this.pos;else if(k(e)){switch(t+=this.input.slice(s,this.pos),++this.pos,e){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(e)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),s=this.pos}else++this.pos}},g.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(i.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},g.readEscapedChar=function(t){let i=this.input.charCodeAt(++this.pos);switch(++this.pos,i){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return C(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),t){const t=this.pos-1;this.invalidStringToken(t,"Invalid escape sequence in template string")}default:if(i>=48&&i<=55){let s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],e=parseInt(s,8);return e>255&&(s=s.slice(0,-1),e=parseInt(s,8)),this.pos+=s.length-1,i=this.input.charCodeAt(this.pos),"0"===s&&56!==i&&57!==i||!this.strict&&!t||this.invalidStringToken(this.pos-1-s.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(e)}return k(i)?"":String.fromCharCode(i)}},g.readHexChar=function(t){let i=this.pos,s=this.readInt(16,t);return null===s&&this.invalidStringToken(i,"Bad character escape sequence"),s},g.readWord1=function(){this.containsEsc=!1;let t="",i=!0,s=this.pos,e=this.options.ecmaVersion>=6;for(;this.pos<this.input.length;){let n=this.fullCharCodeAtPos();if(p(n,e))this.pos+=n<=65535?1:2;else{if(92!==n)break;{this.containsEsc=!0,t+=this.input.slice(s,this.pos);let n=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;let h=this.readCodePoint();(i?a:p)(h,e)||this.invalidStringToken(n,"Invalid Unicode escape"),t+=C(h),s=this.pos}}i=!1}return t+this.input.slice(s,this.pos)},g.readWord=function(){let t=this.readWord1(),e=i.name;return this.keywords.test(t)&&(e=s[t]),this.finishToken(e,t)},{Token:T}});
//# sourceMappingURL=sourcemaps/tokenize.js.map
