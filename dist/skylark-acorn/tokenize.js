/**
 * skylark-acorn - A version of acorn that ported to running on skylarkjs.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./identifier","./tokentype","./state","./locutil","./regexp","./whitespace","./util"],function(t,i,s,e,n,h,o){"use strict";const{isIdentifierStart:r,isIdentifierChar:a}=t,{types:p,keywords:c}=i,{Parser:u}=s,{SourceLocation:l}=e,{RegExpValidationState:d}=n,{lineBreak:f,nextLineBreak:k,isNewLine:m,nonASCIIwhitespace:C}=h,{codePointToString:T}=o;class g{constructor(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new l(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])}}const A=u.prototype;function b(t){return"function"!=typeof BigInt?null:BigInt(t.replace(/_/g,""))}A.next=function(t){!t&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new g(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},A.getToken=function(){return this.next(),new g(this)},"undefined"!=typeof Symbol&&(A[Symbol.iterator]=function(){return{next:()=>{let t=this.getToken();return{done:t.type===p.eof,value:t}}}}),A.nextToken=function(){let t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(p.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},A.readToken=function(t){return r(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},A.fullCharCodeAtPos=function(){let t=this.input.charCodeAt(this.pos);if(t<=55295||t>=56320)return t;let i=this.input.charCodeAt(this.pos+1);return i<=56319||i>=57344?t:(t<<10)+i-56613888},A.skipBlockComment=function(){let t=this.options.onComment&&this.curPosition(),i=this.pos,s=this.input.indexOf("*/",this.pos+=2);if(-1===s&&this.raise(this.pos-2,"Unterminated comment"),this.pos=s+2,this.options.locations)for(let t,s=i;(t=k(this.input,s,this.pos))>-1;)++this.curLine,s=this.lineStart=t;this.options.onComment&&this.options.onComment(!0,this.input.slice(i+2,s),i,this.pos,t,this.curPosition())},A.skipLineComment=function(t){let i=this.pos,s=this.options.onComment&&this.curPosition(),e=this.input.charCodeAt(this.pos+=t);for(;this.pos<this.input.length&&!m(e);)e=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(i+t,this.pos),i,this.pos,s,this.curPosition())},A.skipSpace=function(){t:for(;this.pos<this.input.length;){let t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&C.test(String.fromCharCode(t))))break t;++this.pos}}},A.finishToken=function(t,i){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());let s=this.type;this.type=t,this.value=i,this.updateContext(s)},A.readToken_dot=function(){let t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);let i=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===i?(this.pos+=3,this.finishToken(p.ellipsis)):(++this.pos,this.finishToken(p.dot))},A.readToken_slash=function(){let t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(p.assign,2):this.finishOp(p.slash,1)},A.readToken_mult_modulo_exp=function(t){let i=this.input.charCodeAt(this.pos+1),s=1,e=42===t?p.star:p.modulo;return this.options.ecmaVersion>=7&&42===t&&42===i&&(++s,e=p.starstar,i=this.input.charCodeAt(this.pos+2)),61===i?this.finishOp(p.assign,s+1):this.finishOp(e,s)},A.readToken_pipe_amp=function(t){let i=this.input.charCodeAt(this.pos+1);if(i===t){if(this.options.ecmaVersion>=12){if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(p.assign,3)}return this.finishOp(124===t?p.logicalOR:p.logicalAND,2)}return 61===i?this.finishOp(p.assign,2):this.finishOp(124===t?p.bitwiseOR:p.bitwiseAND,1)},A.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(p.assign,2):this.finishOp(p.bitwiseXOR,1)},A.readToken_plus_min=function(t){let i=this.input.charCodeAt(this.pos+1);return i===t?45!==i||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!f.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(p.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===i?this.finishOp(p.assign,2):this.finishOp(p.plusMin,1)},A.readToken_lt_gt=function(t){let i=this.input.charCodeAt(this.pos+1),s=1;return i===t?(s=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+s)?this.finishOp(p.assign,s+1):this.finishOp(p.bitShift,s)):33!==i||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===i&&(s=2),this.finishOp(p.relational,s)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},A.readToken_eq_excl=function(t){let i=this.input.charCodeAt(this.pos+1);return 61===i?this.finishOp(p.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===i&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(p.arrow)):this.finishOp(61===t?p.eq:p.prefix,1)},A.readToken_question=function(){const t=this.options.ecmaVersion;if(t>=11){let i=this.input.charCodeAt(this.pos+1);if(46===i){let t=this.input.charCodeAt(this.pos+2);if(t<48||t>57)return this.finishOp(p.questionDot,2)}if(63===i){if(t>=12){if(61===this.input.charCodeAt(this.pos+2))return this.finishOp(p.assign,3)}return this.finishOp(p.coalesce,2)}}return this.finishOp(p.question,1)},A.readToken_numberSign=function(){let t=35;if(this.options.ecmaVersion>=13&&(++this.pos,t=this.fullCharCodeAtPos(),r(t,!0)||92===t))return this.finishToken(p.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+T(t)+"'")},A.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(p.parenL);case 41:return++this.pos,this.finishToken(p.parenR);case 59:return++this.pos,this.finishToken(p.semi);case 44:return++this.pos,this.finishToken(p.comma);case 91:return++this.pos,this.finishToken(p.bracketL);case 93:return++this.pos,this.finishToken(p.bracketR);case 123:return++this.pos,this.finishToken(p.braceL);case 125:return++this.pos,this.finishToken(p.braceR);case 58:return++this.pos,this.finishToken(p.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(p.backQuote);case 48:let i=this.input.charCodeAt(this.pos+1);if(120===i||88===i)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===i||79===i)return this.readRadixNumber(8);if(98===i||66===i)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 63:return this.readToken_question();case 126:return this.finishOp(p.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+T(t)+"'")},A.finishOp=function(t,i){let s=this.input.slice(this.pos,this.pos+i);return this.pos+=i,this.finishToken(t,s)},A.readRegexp=function(){let t,i,s=this.pos;for(;;){this.pos>=this.input.length&&this.raise(s,"Unterminated regular expression");let e=this.input.charAt(this.pos);if(f.test(e)&&this.raise(s,"Unterminated regular expression"),t)t=!1;else{if("["===e)i=!0;else if("]"===e&&i)i=!1;else if("/"===e&&!i)break;t="\\"===e}++this.pos}let e=this.input.slice(s,this.pos);++this.pos;let n=this.pos,h=this.readWord1();this.containsEsc&&this.unexpected(n);const o=this.regexpState||(this.regexpState=new d(this));o.reset(s,e,h),this.validateRegExpFlags(o),this.validateRegExpPattern(o);let r=null;try{r=new RegExp(e,h)}catch(t){}return this.finishToken(p.regexp,{pattern:e,flags:h,value:r})},A.readInt=function(t,i,s){const e=this.options.ecmaVersion>=12&&void 0===i,n=s&&48===this.input.charCodeAt(this.pos);let h=this.pos,o=0,r=0;for(let s=0,h=null==i?1/0:i;s<h;++s,++this.pos){let i,h=this.input.charCodeAt(this.pos);if(e&&95===h)n&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===r&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===s&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),r=h;else{if((i=h>=97?h-97+10:h>=65?h-65+10:h>=48&&h<=57?h-48:1/0)>=t)break;r=h,o=o*t+i}}return e&&95===r&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===h||null!=i&&this.pos-h!==i?null:o},A.readRadixNumber=function(t){let i=this.pos;this.pos+=2;let s=this.readInt(t);return null==s&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(s=b(this.input.slice(i,this.pos)),++this.pos):r(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(p.num,s)},A.readNumber=function(t){let i=this.pos;t||null!==this.readInt(10,void 0,!0)||this.raise(i,"Invalid number");let s=this.pos-i>=2&&48===this.input.charCodeAt(i);s&&this.strict&&this.raise(i,"Invalid number");let e=this.input.charCodeAt(this.pos);if(!s&&!t&&this.options.ecmaVersion>=11&&110===e){let t=b(this.input.slice(i,this.pos));return++this.pos,r(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(p.num,t)}s&&/[89]/.test(this.input.slice(i,this.pos))&&(s=!1),46!==e||s||(++this.pos,this.readInt(10),e=this.input.charCodeAt(this.pos)),69!==e&&101!==e||s||(43!==(e=this.input.charCodeAt(++this.pos))&&45!==e||++this.pos,null===this.readInt(10)&&this.raise(i,"Invalid number")),r(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");let n=(h=this.input.slice(i,this.pos),s?parseInt(h,8):parseFloat(h.replace(/_/g,"")));var h;return this.finishToken(p.num,n)},A.readCodePoint=function(){let t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();let i=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(i,"Code point out of bounds")}else t=this.readHexChar(4);return t},A.readString=function(t){let i="",s=++this.pos;for(;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");let e=this.input.charCodeAt(this.pos);if(e===t)break;92===e?(i+=this.input.slice(s,this.pos),i+=this.readEscapedChar(!1),s=this.pos):8232===e||8233===e?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(m(e)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return i+=this.input.slice(s,this.pos++),this.finishToken(p.string,i)};const x={};return A.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t!==x)throw t;this.readInvalidTemplateToken()}this.inTemplateElement=!1},A.invalidStringToken=function(t,i){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw x;this.raise(t,i)},A.readTmplToken=function(){let t="",i=this.pos;for(;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");let s=this.input.charCodeAt(this.pos);if(96===s||36===s&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==p.template&&this.type!==p.invalidTemplate?(t+=this.input.slice(i,this.pos),this.finishToken(p.template,t)):36===s?(this.pos+=2,this.finishToken(p.dollarBraceL)):(++this.pos,this.finishToken(p.backQuote));if(92===s)t+=this.input.slice(i,this.pos),t+=this.readEscapedChar(!0),i=this.pos;else if(m(s)){switch(t+=this.input.slice(i,this.pos),++this.pos,s){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(s)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),i=this.pos}else++this.pos}},A.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(p.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},A.readEscapedChar=function(t){let i=this.input.charCodeAt(++this.pos);switch(++this.pos,i){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return T(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),t){const t=this.pos-1;this.invalidStringToken(t,"Invalid escape sequence in template string")}default:if(i>=48&&i<=55){let s=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],e=parseInt(s,8);return e>255&&(s=s.slice(0,-1),e=parseInt(s,8)),this.pos+=s.length-1,i=this.input.charCodeAt(this.pos),"0"===s&&56!==i&&57!==i||!this.strict&&!t||this.invalidStringToken(this.pos-1-s.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(e)}return m(i)?"":String.fromCharCode(i)}},A.readHexChar=function(t){let i=this.pos,s=this.readInt(16,t);return null===s&&this.invalidStringToken(i,"Bad character escape sequence"),s},A.readWord1=function(){this.containsEsc=!1;let t="",i=!0,s=this.pos,e=this.options.ecmaVersion>=6;for(;this.pos<this.input.length;){let n=this.fullCharCodeAtPos();if(a(n,e))this.pos+=n<=65535?1:2;else{if(92!==n)break;{this.containsEsc=!0,t+=this.input.slice(s,this.pos);let n=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;let h=this.readCodePoint();(i?r:a)(h,e)||this.invalidStringToken(n,"Invalid Unicode escape"),t+=T(h),s=this.pos}}i=!1}return t+this.input.slice(s,this.pos)},A.readWord=function(){let t=this.readWord1(),i=p.name;return this.keywords.test(t)&&(i=c[t]),this.finishToken(i,t)},{Token:g}});
//# sourceMappingURL=sourcemaps/tokenize.js.map
